# path: ~/.config/yazi/keymap.toml
# version: yazi v26.1.22 | macOS Tahoe (M4 Max) | HHKB Type-S
# date: 2026-02-09
# CHANGELOG: 2026-02-09 | Ground-up rewrite: delta-only architecture | ROLLBACK: Restore full keymap.toml from git

"$schema" = "https://yazi-rs.github.io/schemas/keymap.json"

# ═══════════════════════════════════════════════════════════════════
# [mgr] — file list pane
# ═══════════════════════════════════════════════════════════════════

[mgr]

# ── OVERRIDES (shadow defaults) ──────────────────────────────────
prepend_keymap = [

  # ── Quit swap ──────────────────────────────────────────────────
  { on = "q", run = "quit --no-cwd-file", desc = "Quit (no cd)" },
  { on = "Q", run = "quit",               desc = "Quit + cd to CWD" },

  # ── Escape: nuclear cancel ─────────────────────────────────────
  { on = "<Esc>", run = "escape --all", desc = "Escape (clear all)" },
  { on = "<C-[>", run = "escape --all", desc = "Escape (clear all)" },
  { on = "<C-c>", run = "escape --all", desc = "Escape (clear all)" },

  # ── Open: hovered only ─────────────────────────────────────────
  { on = "<Enter>", run = "open --hovered", desc = "Open hovered file" },

  # ── Disable                                     ────────────────
  { on = "o",    run = "noop", desc = "Reserved: open/* prefix" },
  { on = ["g", "c"], run = "noop", desc = "Disabled: use g,t,c" },
  { on = ["g", "d"], run = "noop", desc = "Disabled: use g,t,d" },
  { on = ["c", "d"], run = "noop", desc = "Disabled: use cp" },

  # ── Clipboard namespace ────────────────────────────────────────
  { on = ["c", "c"], run = "shell --confirm 'YAZI_HOVERED=\"$0\" \"$HOME/.config/yazi/scripts/copy-contents.sh\" $@'", desc = "[copy] content(s)" },
  { on = ["c", "t"], run = "shell --confirm 'YAZI_HOVERED=\"$0\" \"$HOME/.config/yazi/scripts/copy-tree.sh\" $@'", desc = "[copy] tree(s)" },
  { on = ["c", "p"], run = "copy path", desc = "[copy] path"},
  { on = "Y", run = ["shell -- cat \"$@\" | pbcopy", "noop"], desc = "[copy] raw" },

  # ── Selection: no auto-advance ─────────────────────────────────
  { on = "<Space>", run = "toggle", desc = "Toggle select (no advance)" },
]

# ── ADDITIONS (new bindings) ─────────────────────────────────────
append_keymap = [

  # ── open/with namespace ────────────────────────────────────────
  { on = ["o", "w", "p"], run = "open --interactive",desc = "open/with/picker" },
  { on = ["o", "w", "c"], run = 'shell --orphan -- sh -lc "command -v code >/dev/null 2>&1 && code -- \"$@\" || open -a \"Visual Studio Code\" \"$@\" "', desc = "open/with/vscode" },
  { on = ["o", "w", "m"], run = 'shell --orphan -- open -a "Modern CSV" "$@"', desc = "edit/with/modern-csv" },
  { on = ["o", "w", "f"], run = 'shell --orphan -- open -R "$@"', desc = "open/with/finder (reveal)" },
  { on = ["o", "t", "t"], run = """shell --orphan -- sh -lc 'tmux new-window -c "$PWD"'""", desc = "open/tmux/tab" },
  { on = ["o", "w", "v"], run = 'shell --block -- nvim "$@"', desc = "open/with/vim" },


  # ── goto/to bookmarks ─────────────────────────────────────────
  { on = ["g", "t", "r"], run = "cd ~/.repository", desc = "go/to/repository" },
  { on = ["g", "t", "c"], run = "cd ~/.config",     desc = "go/to/config" },
  { on = ["g", "t", "d"], run = "cd ~/Downloads",     desc = "go/to/downloads" },

  # ── goto/to western ─────────────────────────────────────────
  { on = ["g", "t", "w", "w"], run = "cd ~/desk/work/westernu",   desc = "go/to/westernu" },
  { on = ["g", "t", "w", "n"], run = "cd ~/desk/work/westernu/notes",   desc = "go/to/westernu/notes" },
  { on = ["g", "t", "w", "p"], run = "cd ~/desk/work/westernu/pipeline",   desc = "go/to/westernu/pipeline" },
  { on = ["g", "t", "w", "c"], run = "cd ~/desk/work/westernu/pipeline/cvmapp",   desc = "go/to/westernu/cvmapp" },
  { on = ["g", "t", "w", "f"], run = "cd ~/desk/work/westernu/pipeline/frank",   desc = "go/to/westernu/frank" },
]

# ═══════════════════════════════════════════════════════════════════
# [input] — rename/create/cd text input
# ═══════════════════════════════════════════════════════════════════
# INHERITS: Full vi-mode (h/l/w/b/e/0/$, i/I/a/A, d/c/s/x/y/p, u/U/<C-r>, v/V/r)
# Only override what you actually want different from defaults.

[input]

prepend_keymap = [
]

